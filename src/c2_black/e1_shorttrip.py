# -*- coding: utf-8 -*-
"""Episode: 2-1.小旅行
"""
## path
import os
import sys
sys.path.append(os.path.join(os.path.dirname(__file__), '../..'))
sys.path.append('storybuilder')
## local libs
from storybuilder.builder.world import World
from storybuilder.builder.writer import Writer


## define alias
W = Writer
_ = W.getWho()


## scenes
def sc_nearwinter(w: World):
    nocht, asahi = W(w.nocht), W(w.asahi)
    inside, outside = W(w.inside), W(w.outside)
    sky = W(w.sky)
    return w.scene("秋のある日",
            w.comment("秋の町中の空気感を"),
            w.symbol("　　　　５"),
            nocht.be("この国の秋は突然やってくる", "&"),
            _.explain("歩道に植わるカバノキや遠くに見える山の色がさっと黄色に変容するのだ",
                "それは誰かにとっては冬の到来を予感させ、ある種類の人間にとってはやっとオーロラの季節だと胸を踊らせる"),
            _.do("ルスカと呼ばれる紅葉だ", "その風を感じながら$Sは自転車で会社に向かう"),
            sky.look("筆先を波打たせながら描いたような雲の連なりに鳥の影が二十ほど、重なって流れていく",
                "&"),
            outside.look("ついこの間まで腕を出してハーフパンツという軽装の人間もいたのに、信号待ちをしている人の列は誰もが長袖にパンツかスカート",
                "人によっては軽めのベストやジャケットを羽織っている"),
            nocht.think("$Sはルスカが一番好きだった",
                "それは彼がこの世に生を受けた季節であり、初めてその存在を感じた出来事があった季節でもあった"),
            w.eventPoint("電子世界", "オブジェクトが似たものが複数ある"),
            nocht.do("ロードバイクは軽快に路脇を走り抜け、同じような建物が並ぶのを視界に収めながら交差点を曲がる",
                "今日もスーパーの駐車場では$frankが大きな鼻を鳴らしながら警棒をぶんぶんと振り回し、元気そうにしている",
                "$Sに気づいて警棒を左右に揺らしたので彼も右手を挙げて応えた"),
            nocht.do("胸ポケットに入れた端末が震え、何かメッセージを受け取ったことを知らせた",
                "速度を緩めて停止すると、慌てて確認する"),
            _.talk("$asahiからだ"),
            _.explain("彼女と出会ってから半年、",
                "最近連絡の頻度が増えた", "最初の頃は日に一度でも返信があれば良い方だったがようやくフランクな関係になってきたのかなと少し嬉しく感じる"),
            _.think("返信の内容を考えながら、思いついて街路樹を写真に収める",
                "彼女の暮らす街には自然が少ないと聞いたけれど、これは人間の手が植えたものだから自然とは呼ばない、なんて言われるのだろうかと思いつつ、",
                "画像を添付してメッセージを送った"),
            camera=w.nocht,
            area=w.Tampere,
            stage=w.on_street,
            day=w.in_autumnday, time=w.at_midmorning,
            )

def sc_getshortvacation(w: World):
    nocht, asahi = W(w.nocht), W(w.asahi)
    mousa, irene, adonis = W(w.mousa), W(w.irene), W(w.adonis)
    inside, outside = W(w.inside), W(w.outside)
    return w.scene("小さな休暇を得る",
            w.comment("仕事の進捗具合が分かるように。ここではまだ慌ててる感じじゃないが、それでもずっと作業してきた、という風"),
            w.symbol("　　　　◆"),
            nocht.be("九月に入り、オフィスにはちらほら新しい顔が増えている", "&"),
            _.explain("十二月の発売を睨んで開発速度を上げなければいけないと$ireneが額に手を当てていたことを思い出しながら、",
                "$Sはパソコンに向かっていた"),
            _.do("画面の中では$Sがデザインした敵キャラクタのＣＧモデルが醜悪な顔を向け、爪の長い手足を動かしては濁声で喚いている",
                "右端のモニタには攻撃方法の仕様が表示されている",
                "全て$adonisが考えたものだが、",
                "攻撃パターンは近距離と遠距離に分けられ、一つ一つに対して事細かな指定がされている",
                "ただそれらは全て言葉や数字で表現されているだけで実際に絵にするのは$Sの仕事だった"),
            nocht.do("思い切り伸びをして、今一度部屋を見回す", "&"),
            inside.look("普段なら夏休みにたっぷりと休養を取って精力に満ち溢れているところだが、",
                "$adonisの急なプラン変更によりそれが潰れ、結局夏間も毎日時間いっぱいまでモニタに向かっていた",
                "パソコン作業がそれほど苦ではない$Sですら流石にアルコールの飲み過ぎでお腹回りが太くなったくらいだから、",
                "誰も彼も表情に疲れという文字を貼り付けていた"),
            irene.come(),
            irene.talk("どう、調子は？"),
            w.eventPoint("ゲーム制作", "新しいデザインの提案"),
            nocht.do("やってきた$ireneも最近はコンタクトではなく眼鏡姿で、疲労が雑にピンで留めた髪に現れている"),
            nocht.talk("ゾンビから何とかまともな生き物っぽくなりましたけど、この『元人間だった』っていう指定はどう解釈したらいいんですかね"),
            _.do("最初は沢山あるゾンビが溢れるサバイバルガンアクションとして計画していたものが、彼の一言で、意味不明な異形の化物を倒しながら荒廃した世界を進む、",
                "謎のアクションアドベンチャーに変更されたのだ", "当初思い描いていた$Sのイメージは全て捨て去る必要があり、",
                "その上彼の思惑が全く読み取れずに、結局何となくでそれっぽいものを作り上げてしまった"),
            irene.talk("$meは良いと思うわよ",
                "特にこっちのお腹の出てるのなんて$mousaみたいで、思い切りショットガンで弾き飛ばしたいわ"),
            _.do("彼女は向こうでポテトを摘みながら時折キーボードをガチャガチャ叩く音をさせては笑っているナイジェリア人を見やって笑みを浮かべる", "&"),
            nocht.think("おそらくヘッドフォンで大音量を耳に流し込んでいる彼にその言葉は届いていないだろうが、",
                "彼女はそれを気にするような人間ではなかったし、", "$mousaもそれくらい何とも思わない"),
            nocht.talk("ところでこれ、どうですか"),
            _.do("マウスを操作し、モニタに映っていた化物のＣＧを別のものに差し替える",
                "それは確かに人間ではない異形の姿だったが、大きな目とおどけた表情をしたネズミを擬人化したような風貌だった",
                "色合いも赤やオレンジを基調に明るく楽しいイメージを与える"),
            irene.talk("ＮＰＣか何かかしら？", "面白いキャラだけどこんなもの仕様書にはなかったわよね？"),
            nocht.talk("指示にあったのはどれだけ工夫しても画面が同じような感じになるし、色味も少ない",
                "ゲームは飽きられたら終わりだからせめて視覚的に飽きないようにと思って、いくつかこういう他のパターンも作ってみたんだ",
                "どうだろうか？"),
            irene.do("そうね、と彼女は腕組みをする"),
            irene.talk("けど、勝手なことするとまた$adonisが怒り出すんじゃないかしら"),
            nocht.think("それは$Sも考えた",
                "でもそれなら一体何の為に自分はここにいるのか、ただ言われたままデザインをしてプログラムを組んで給料貰っているだけの存在でいいのか、",
                "という疑問を無視することができなかっただけだ"),
            nocht.talk("ベストゲームの為だって言ってやりますよ",
                "あいつの口癖でしょう？",
                "ベターよりもベストを選べ", "$meたちはベストゲームを作り続けないと駄目なんだって",
                "それに不気味なだけじゃあ売上に繋がらないっていうのは『$game1』で証明済みですよね？"),
            irene.do("最初に出して大きな借金を抱えることになったゲームソフトの名を出すと、彼女は渋面になって「それは言わないで」と手で制止する"),
            irene.talk("$nochtの気持ちは分かったわ", "でもね、その調整をするのが誰か知ってる？"),
            adonis.come(),
            adonis.talk("なんだこれは"),
            nocht.do("プロジェクトリーダーである$ireneの仕事だ、と答えようとしたところに運悪く$adonisがやってきた",
                "モニタにはネズミ風なＣＧ以外にもウサギやヒツジなどを擬人化したものが表示され、",
                "どこかのテーマパークを模したような空気感が漂っている"),
            adonis.talk("これは何だと訊いているんだが？"),
            nocht.talk("趣味のＣＧだよ", "不気味な怪物ばかり作ってると精神が病んでしまうんでね"),
            nocht.do("モニタを元の異形に切り替えながら説明するが、$adonisは鼻で笑う"),
            adonis.talk("また$meの指示を無視して勝手なもの作ったんだろ？",
                    "デザインの細部を決めるのはお前の仕事だが全体のコンセプトを損ねるようなものまで作れとは言ってないし書いてもいない",
                    "コンセプト",
                    "分かるか？　お前に？"),
            nocht.talk("半月も前に一人で変えたコンセプトなんて$meは知らないよ",
                    "それよりこのゲーム、そもそもどんなストーリーなのか、いい加減に聞かせてもらえないかな？",
                    "それこそコンセプトってやつも合わせてな"),
            adonis.talk("全部仕様書に書いてあるさ", "それを読んでも理解できないならその程度のオツムってことだろう？"),
            irene.talk("ちょっと$nocht、$adonis"),
            _.do("険悪になった二人の間に$ireneが割って入った","&"),
            nocht.do("$Sは斜に自分を見ている$adonisに対してそれがどうしたと言わんばかりの態度で首を背ける",
                    "性格もそうだが何より感性が合わない", "そもそも$ireneが言う彼の有能さというのがさっぱり理解できないのだ"),
            irene.talk("全く", "はい、ちょっと", "みんな手を止めて"),
            _.do("大きな溜息に続き、手を叩いて$Sは注意を惹きつける"),
            irene.talk("$adonis、いいわね？"),
            adonis.talk("仕方ない"),
            irene.talk("$adonisとも話し合ったんだけど、ゲームのプロトタイプに関しては何とか順調に出来上がったと思ってるわ",
                    "方向性も今後大きくは変わらないし、スケジュール的にも充分十二月の発売には間に合う",
                    "それで、これは提案というよりも命令みたいなものなんだけれど、",
                    "三日だけ一斉休暇を取ってもらうことにしたわ"),
            nocht.do("突然のチーフの言い出しにオフィスがざわつく"),
            mousa.talk("こりゃまたどういう風の吹き回しだ？", "今までここがどこだろうときっちり仕事しないと食いっぱぐれるからとにかくやれ、",
                    "って言い続けてきたのはあんたらだろ？"),
            _.do("やってきた$mousaはコーラの缶を手にしたまま$ireneの前に立つ"),
            irene.talk("みんな精神的にそろそろ疲弊してるから一度リフレッシュした方が良いっていう結論なだけよ",
                    "$meの本心で言えばたった三日でも間に合わなくなる可能性があるからとにかくやれと言いたいところ",
                    "けど人間はロボットじゃないからね",
                    "ここはこのゲームの世界じゃないわ", "ディストピアにしたい訳じゃないってだけ"),
            irene.do("分かったかしら、と両手を広げて見せたが、その場の誰も素直に受け取った訳ではなさそうだ","&"),
            nocht.do("急な態度の変更で気味が悪いな、という空気をプログラマたちは共有しているように$Sには思えた"),
            nocht.talk("突然会社が潰れたり、解雇されたり、露頭に迷うことにはならないんですよね？"),
            irene.do("その$nochtの問いかけに彼女は呆れて見せる"),
            irene.talk("なんでそんな心配されなくちゃならないのよ",
                    "ゲームを十二月に発売して大ヒットさせる", "それで事業資金を回収して次のゲームを作る予定はまだ一ミリと変更されてないわよ"),
            nocht.do("その言葉を聞いて、やっと$Sたちは安堵と休暇の喜びで声を漏らす"),
            stage=w.on_office_int,
            time=w.at_afternoon,
            )

def sc_gototrip(w: World):
    nocht, asahi = W(w.nocht), W(w.asahi)
    irene, adonis = W(w.irene), W(w.adonis)
    mirei = W(w.mirei)
    inside = W(w.inside)
    return w.scene("旅行に行こう",
            w.symbol("　　　　６"),
            nocht.be("その日は午後四時に解散となり、$Sは$on_cafebarのカウンターに座っていた", "&"),
            inside.look("久しぶりに定時で上がるといつもに比べて客入りは少ない", "それでもテーブル席は半分以上埋まり、既にアルコールが入っている賑やかなところもあった"),
            adonis.be(),
            _.talk("うるさいのは苦手なんだ"),
            nocht.do("そうぼやいて隣で渋面のままウォッカを流し込む男を見て、$Sは何故こうなったのかと自問していた"),
            _.talk("文句を言うくらいならそれ飲んでさっさと出て行ってくれないか？",
                "こっちは寛ぎの時間なんだ", "あんたに邪魔されたくない"),
            adonis.talk("$nocht、お前とは一度ちゃんと話をつけておいた方が良いと思ってるんだ"),
            _.do("$CSの言葉が耳に入らなかったのか、$Sはツマミに頼んだベリージャムの乗った$leipajuustoを切り分け、フォークで突き刺して口に運ぶ",
                "焼き目が付いたチーズパンは彼の口の中でキュキュっと音を立てているのが想像できた"),
            mirei.talk("はいお待ち"),
            mirei.do("その間に割って入るようにしてやってきた店員の$mireiは濃いアイシャドウの瞳を$adonisに向けつつ、$CSの前にプレートとビールのボトルを置くが、",
                "彼は関心がないらしく、ちらとも目線を合わせない",
                "$mireiは不満そうに唇を尖らせると決済端末を$CSに向けた",
                "端末を重ねて支払いを済ますと「そういうやつなんだ」と耳打ちをして追い払う"),
            nocht.talk("で、何の話がしたいんだ？　まさか女のことじゃないだろうな"),
            _.do("$asahiからはまだ何もメッセージが来ていない",
                "それもそうだろう", "この時間は普段なら仕事中だ", "彼女は$Sの仕事の時間を上手く外してメッセージを送ってくる", "そういう女性だった"),
            adonis.talk("女は間に合ってるよ", "そうじゃなくてゲームの話だ",
                "$meの企画の気に入らないところを十、言ってくれ"),
            nocht.think("どういうつもりでそんなことを口にしたか分からないが、$Sはビールに伸ばした手を戻し、指を出しながら一つ一つ口にした"),
            nocht.talk("まず文章が気に入らないだろ",
                "指示は細かすぎで、数字は具体的なのにいざＣＧモデルにしたら関係性が滅茶苦茶で破綻してる",
                "そもそもゲームとしての動きを全く無視して手が伸びるとかビームが出るとか、設定ってものを多少なりとも論理的に考えているとは思えない"),
            adonis.talk("ちょっと待て"),
            nocht.talk("あんたが言えって言ったんだが？"),
            adonis.do("$Sは慌てた様子で何度も「待て」と掌を向ける"),
            _.talk("仕事中はそこまで率直に物言いをするようなタイプじゃなかっただろう？", "それともこれが君の本性か？"),
            nocht.talk("一応ディレクターだということで僅かばかりの敬意を払っているからだよ",
                "あと、$ireneの手前もある",
                "なんだかんだ$meたちみんな、彼女に信頼を置いている"),
            adonis.talk("新参者には厳しい、と、そういう訳か",
                "排他的だな、全く"),
            _.do("ギリシア系ドイツ人だという$Sはその堀深い顔を左右に振り、ウォッカの残りを煽った",
                "既に頬は赤く、彼のブラウンの瞳も虚ろだ"),
            nocht.talk("あんたが嫌いという訳じゃない",
                "ただ、信頼を手に入れるまではそれなりに時間がかかるというだけだ",
                "前の会社じゃどうだったんだ？"),
            adonis.talk("孤独だったさ",
                "でも才能というのはいつも孤独なものだ",
                "$meはね、$nocht、誰かの為に自分の感情を犠牲にするなんてただの罪だと思っている",
                "それで少しは良いことをしてるつもりかも知れないが実際やってることは自己満足で、ただのエゴだ",
                "そんな面倒な偽善塗れのエゴを見せびらかすくらいなら$meは自分自身の為にそのエゴを使う",
                "そうやってどこでも結果を出してきた",
                "だからここでも$meは同じやり方でやらせてもらう"),
            _.do("そこまで言うと、残りの$leipajuustoを無理矢理に口に突っ込み、席を立った"),
            nocht.talk("おい"),
            _.do("何か言っておかないといけないと声を掛けたが$adonisはチャオとばかりに背中を向けたまま手を振り、店から出て行ってしまった"),
            nocht.talk("話くらい聞けばいいんだ", "そういうところが孤独を助長するんじゃないのか"),
            w.eventStart("$asahiにオーロラを見せる"),
            _.do("ビールを口にし、ささくれだった気分を洗い流す",
                    "ちょうどそこに$asahiからのメッセージが到着した"),
            asahi.voice("おつかれさま", "それにしても急に休みができるのね"),
            nocht.do("チーフの強権により強制的に三日休みになったと送っておいた、それに対する返信だった",
                    "$Sはプレートの上のニシンを突きながらどう返したものか考える"),
            nocht.think("――いつだって決定を耳にするのは突然さ",
                    "けどこれもチーフたちが必死に考えたことなんだ",
                    "ただの思いつきじゃないことは知ってるから、$meたちは渋々従うだけさ"),
            asahi.voice("前にも訊いたかも知れないけど、そのチーフの女性のことを随分と信頼しているのね",
                    "少し羨ましいわ"),
            nocht.think("彼女は物置みたいな何も文句をつけない上司に満足していると言っていたことを思い出す",
                    "そんな状況でも不満があるのだろうか"),
            nocht.think("――そういえば$asahiはオーロラを見たことがないと言っていたね"),
            asahi.voice("$w_japanで見える場所もあると聞いているけれど、特別それを観測する為に出かけようとは思わないわ",
                "研究をしている方がずっと楽しいもの"),
            nocht.think("――君は本当に仕事好きだね。$w_japaneseはみんなそうなのか？"),
            asahi.voice("あら、あなただって仕事が好きでしょ？"),
            nocht.think("――仕事よりも絵を書いたりＣＧモデル作ってる方がずっと有意義さ"),
            _.do("こういう何気ない会話をしながら酒を飲むのが最近の一番の楽しみになっていた",
                    "それに一人でいた時よりも彼女と言葉を交わしている時の方があれこれと発想が巡る"),
            nocht.think("――そうだ、$asahi", "オーロラを見に行かないか？"),
            asahi.voice("どういう意味？", "$meに$nochtの国まで飛んでこいとでも？"),
            nocht.think("――そうしてくれたら確かに嬉しいが三日じゃ君が有給申請している間に終わるだろう？",
                    "$w_japanはそういう国だと聞いてる"),
            asahi.voice("そこまでじゃないけど、まあ無理ね"),
            nocht.think("――これから$Rovaniemiまでバイクで走ってオーロラを見つけてくる",
                "$asahiには採れたての映像をライブ配信してあげるよ", "どうだい？", "とっても良いアイデアじゃないか"),
            _.think("彼女は「そうね」と納得したのか、呆れたのか、よく分からない返事を寄越したが、",
                    "$Sの中では是非そうすべきだという気分が盛り上がっていた"),
            _.do("すぐにプレートの残りを食べ終え、立ち上がる", "&"),
            _.do("必要なものを買い揃えて出かける準備をするのだ"),
            nocht.talk("楽しくなってきた", "良いバカンスになりそうだ"),
            nocht.do("思わず声が漏れた彼を見て、店員の$mireiが目を大きくして首を傾げていた"),
            stage=w.on_cafebar_int,
            time=w.at_evening,
            )

## episode
def ep_short_trip(w: World):
    return w.episode("2-1.小旅行",
            sc_nearwinter(w),
            sc_getshortvacation(w),
            sc_gototrip(w),
            ## NOTE
            ##  - 秋になるとオーロラが徐々に見える日が増える
            ##  - ゲーム開発に一段落つき、ノクトは数日休暇をもらえた
            ##  - アサヒにオーロラを見せるため、オーロラ観測の小旅行へと出かける
            note="秋になり、オーロラの季節が到来。開発に一段落つき、数日休みとなったので気分転換に観測小旅行へと出かけた")
